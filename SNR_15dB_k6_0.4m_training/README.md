# SNR 15dB + k=6 + 거리 0.4m 학습

## 📋 **실험 개요**
- **목적**: k=6 이웃 연결을 통한 균형잡힌 공간 관계 학습
- **배경**: k=5와 k=8 사이의 중간점으로 적절한 이웃 영향 확보

## ⚙️ **모델 파라미터**
| 파라미터 | 값 | 선택 이유 |
|---------|-----|----------|
| **SNR 임계값** | 15.0 dB | 도메인 적응 균형 기준 |
| **거리 임계값** | 0.4 m | 중간 지점 (0.3m과 0.5m 사이) |
| **k-NN 연결** | 6개 | 균형잡힌 이웃 영향 (k=5와 k=8 사이) |
| **학습 에포크** | 50 | 기본 설정 |
| **배치 크기** | 16 | 기본 설정 |
| **학습률** | 0.005 | Adam 옵티마이저 |

## 📊 **학습 결과**
- **최고 검증 정확도**: 학습 후 업데이트 예정
- **실제 타겟 비율**: 학습 후 업데이트 예정
- **고스트 타겟 비율**: 학습 후 업데이트 예정
- **총 그래프**: 2,090개 (예상)
- **총 노드**: 65,188개 (예상)

## 📁 **파일 구조**
```
SNR_15dB_k6_0.4m_training/
├── ghost_detector_k6_15dB_0.4m.py     # k=6 학습 스크립트
├── ghost_detector_k6_15dB_0.4m.pth    # 학습된 모델 (학습 후 생성)
├── k6_training_analysis.png           # k=6 학습 데이터 분석
├── hybrid_ghost_gnn.py                # GNN 모델 정의
├── data_structures.py                 # 데이터 구조 정의
├── RadarMap_v2.txt                   # 학습용 레이더 데이터 (복사 필요)
├── LiDARMap_v2.txt                   # 학습용 LiDAR 데이터 (복사 필요)
└── requirements.txt                  # 패키지 의존성
```

## 🎯 **라벨링 규칙**
```python
if distance <= 0.4m AND snr >= 15.0dB:  # k=6 균형 기준
    label = 1  # 실제 타겟
else:
    label = 0  # 고스트 타겟
```

## 🎨 **학습 데이터 시각화**

### 📊 **k6_training_analysis.png**
4패널 구성으로 k=6 기준 분석:
1. **손실 함수**: 학습/검증 손실 변화
2. **정확도**: 학습/검증 정확도 변화
3. **데이터 분포**: 실제 vs 고스트 타겟 비율
4. **모델 설정**: k=6 파라미터 및 성능 정보

## 🚀 **사용법**
```bash
# 데이터 파일 복사 (메인 폴더에서)
cp RadarMap_v2.txt SNR_15dB_k6_0.4m_training/
cp LiDARMap_v2.txt SNR_15dB_k6_0.4m_training/

# k=6 학습 실행
cd SNR_15dB_k6_0.4m_training
python3 ghost_detector_k6_15dB_0.4m.py

# GPU 환경 확인
python3 -c "import torch; print(f'CUDA: {torch.cuda.is_available()}')"
```

## 📈 **성능 분석**

### 📊 **k=6 이웃 연결의 특징**
| 지표 | k=4 | k=5 | **k=6** | k=8 |
|------|-----|-----|---------|-----|
| **이웃 영향** | 제한적 | 적절 | **균형** | 과도 |
| **계산 복잡도** | 낮음 | 보통 | **보통** | 높음 |
| **공간 관계** | 국소적 | 중간 | **포괄적** | 광범위 |

### ✅ **k=6 설정의 장점**
1. **균형잡힌 이웃**: k=5보다 약간 더 많은 공간 정보 활용
2. **적절한 복잡도**: k=8보다 계산 효율적
3. **안정적 학습**: 과적합 위험 감소
4. **실용적 성능**: 실제 환경에서 검증된 범위

### 🎯 **k=6 선택 근거**

#### **공간 관계 학습**:
- **k=4**: 너무 국소적, 주변 패턴 놓칠 가능성
- **k=5**: 적절하지만 약간 제한적
- **k=6**: 충분한 이웃 정보로 패턴 학습 향상
- **k=8**: 과도한 연결로 노이즈 증가 가능

#### **계산 효율성**:
- k=6은 성능과 효율성의 균형점
- 실시간 추론에서도 적절한 속도 유지
- GPU 메모리 사용량 최적화

#### **일반화 성능**:
- 다양한 레이더 패턴에 대한 강건성
- 과적합 방지와 학습 능력의 균형

## 🔍 **k=6 vs 다른 k 값 비교**
### **예상 성능 차이**:
```
k=4: 빠르지만 정보 부족 → 정확도 약간 낮음
k=5: 균형잡힌 기준점 → 안정적 성능
k=6: 향상된 공간 인식 → 정확도 개선 기대
k=8: 풍부한 정보 → 과적합 위험
```

### **실제 환경 적용**:
- k=6은 복잡한 레이더 환경에서 더 나은 성능 기대
- 고스트 타겟의 공간적 패턴을 더 잘 학습
- 실제 타겟 주변의 맥락 정보 활용 향상

## 🏆 **결론**
SNR 15dB + k=6 + 거리 0.4m 조합은:
- **향상된 공간 인식**: k=5보다 더 포괄적인 이웃 관계 학습
- **균형잡힌 복잡도**: 성능 향상과 효율성의 최적 균형
- **실용적 선택**: 실제 배포 환경에서 검증된 범위
- **안정적 학습**: 과적합 위험 최소화

## 🔄 **향후 활용**
이 k=6 모델은:
- 복잡한 레이더 환경에서의 향상된 성능 기대
- k=5 모델과의 성능 비교 분석 기준
- 더 정교한 공간 패턴 학습이 필요한 환경에 적합
