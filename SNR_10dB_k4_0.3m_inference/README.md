# SNR 10dB + k=4 + 거리 0.3m 추론 (엄격한 기준)

## 📋 **실험 개요**
- **목적**: 엄격한 기준으로 학습된 모델의 추론 성능 평가
- **추론 데이터**: RadarMap_bokdo3_v6.txt, LiDARMap_bokdo3_v6.txt

## ⚙️ **모델 파라미터**
| 파라미터 | 값 | 기존 대비 변화 |
|---------|-----|-------------|
| **사용 모델** | ghost_detector_k4_0.3m.pth | 엄격한 기준 학습 |
| **학습 정확도** | 73.50% | 91.34% → 73.50% (하락) |
| **k-NN 연결** | 4개 | 8개 → 4개 (감소) |
| **거리 기준** | 0.3m | 0.5m → 0.3m (엄격화) |

## 📊 **추론 결과**
- **총 레이더 포인트**: 14,809개
- **실제 타겟**: 2,802개 (18.9%)
- **고스트 타겟**: 12,007개 (81.1%)
- **평균 확률**: 0.503
- **처리된 프레임**: 1,777개

## 📁 **파일 구조**
```
SNR_10dB_k4_0.3m_inference/
├── inference_k4_0.3m.py           # 엄격한 기준 추론 스크립트
├── ghost_detector_k4_0.3m.pth     # 엄격한 기준 학습 모델
├── strict_all_frames.png          # 전체 프레임 시각화
├── strict_radar_focused.png       # 레이더 중심 확대 시각화
├── hybrid_ghost_gnn.py            # GNN 모델 정의
├── data_structures.py             # 데이터 구조 정의
├── RadarMap_bokdo3_v6.txt         # 추론용 레이더 데이터
├── LiDARMap_bokdo3_v6.txt         # 추론용 LiDAR 데이터
└── requirements.txt               # 패키지 의존성
```

## 🎨 **시각화 결과**

### 📊 **strict_all_frames.png**
엄격한 기준 전체 프레임 분석:
1. **원본 데이터**: LiDAR + Radar (SNR 색상)
2. **엄격한 예측**: Real(초록) vs Ghost(빨강) - 매우 보수적
3. **예측 확률**: 낮은 평균 확률 (0.503)
4. **통계 정보**: 엄격한 기준의 효과

### 🔍 **strict_radar_focused.png**
엄격한 기준 레이더 중심 확대:
- 대부분 고스트로 분류 (81.1%)
- LiDAR 바로 옆 레이더도 고스트 판정
- 과도하게 보수적인 결과

## 🚀 **사용법**
```bash
# 엄격한 기준 추론 실행
python3 inference_k4_0.3m.py
```

## 📈 **성능 분석**

### 📊 **기존 모델과 비교**
| 지표 | 기존 (k=8, 0.5m) | 엄격 (k=4, 0.3m) | 변화 |
|------|------------------|------------------|------|
| **Real Targets** | 14,649 (98.9%) | 2,802 (18.9%) | -80.9% |
| **Ghost Targets** | 160 (1.1%) | 12,007 (81.1%) | +7,400% |
| **평균 확률** | 0.536 | 0.503 | -6.2% |

### ✅ **장점**
- 매우 높은 고스트 탐지 정밀도
- False Positive 대폭 감소
- 보수적이고 안전한 판단

### ⚠️ **심각한 문제점**
- **과도한 보수성**: LiDAR 바로 옆 레이더도 고스트 판정
- **실용성 부족**: 실제 타겟을 너무 많이 놓침
- **0.3m 기준 문제**: 센서 정확도 한계 고려 부족

## 🔍 **문제 원인 분석**
1. **0.3m 임계값**: 레이더-LiDAR 센서 오차 고려 부족
2. **k=4 연결**: 이웃 정보 부족으로 과도한 개별 판단
3. **도메인 차이**: 학습 데이터와 추론 데이터 환경 차이

## 🔄 **개선 방향**
이 실험으로 0.3m 기준의 한계 확인:
- 거리 임계값을 0.5m로 복원 필요
- k=4는 유지하되 거리 기준 완화
- 정밀도와 재현율의 실용적 균형점 탐색
