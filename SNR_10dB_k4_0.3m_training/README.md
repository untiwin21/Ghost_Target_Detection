# SNR 10dB + k=4 + 거리 0.3m 학습 (엄격한 기준)

## 📋 **실험 개요**
- **목적**: 고스트 탐지 정밀도 향상을 위한 엄격한 기준 적용
- **변경사항**: k-NN 연결 감소 + 거리 임계값 강화

## ⚙️ **모델 파라미터**
| 파라미터 | 값 | 기존 대비 변화 |
|---------|-----|-------------|
| **SNR 임계값** | 10.0 dB | 유지 |
| **거리 임계값** | 0.3 m | 0.5m → 0.3m (엄격화) |
| **k-NN 연결** | 4개 | 8개 → 4개 (감소) |
| **학습 에포크** | 50 | 유지 |
| **배치 크기** | 16 | 유지 |
| **학습률** | 0.005 | 유지 |

## 📊 **학습 결과**
- **최고 검증 정확도**: 73.50%
- **실제 타겟 비율**: 22.2% (14,490개)
- **고스트 타겟 비율**: 77.8% (50,698개)
- **총 그래프**: 2,090개
- **총 노드**: 65,188개

## 📁 **파일 구조**
```
SNR_10dB_k4_0.3m_training/
├── ghost_detector_k4_0.3m.py      # 엄격한 기준 학습 스크립트
├── ghost_detector_k4_0.3m.pth     # 학습된 모델 (73.50% 정확도)
├── training_data_analysis.png      # 학습 데이터 분석 시각화
├── hybrid_ghost_gnn.py            # GNN 모델 정의
├── data_structures.py             # 데이터 구조 정의
├── RadarMap_v2.txt               # 학습용 레이더 데이터
├── LiDARMap_v2.txt               # 학습용 LiDAR 데이터
└── requirements.txt              # 패키지 의존성
```

## 🎯 **엄격한 라벨링 규칙**
```python
if distance <= 0.3m AND snr >= 10.0dB:  # 더 엄격
    label = 1  # 실제 타겟
else:
    label = 0  # 고스트 타겟
```

## 🎨 **학습 데이터 시각화**

### 📊 **training_data_analysis.png**
4패널 구성으로 엄격한 기준 분석:
1. **원본 데이터**: LiDAR + Radar (SNR 색상)
2. **엄격한 라벨링**: 0.3m + 10dB 기준 적용 결과
3. **거리 분포**: 0.3m vs 0.5m 임계값 비교 히스토그램
4. **통계 정보**: 엄격한 기준의 효과 분석

## 🚀 **사용법**
```bash
# 엄격한 기준 학습 실행
python3 ghost_detector_k4_0.3m.py

# GPU 환경 확인
python3 -c "import torch; print(f'CUDA: {torch.cuda.is_available()}')"
```

## 📈 **성능 분석**
### ✅ **장점**
- 더 엄격한 실제 타겟 기준 (22.2% vs 35.1%)
- 고스트 타겟 비율 증가 (77.8% vs 64.9%)
- k=4로 이웃 과의존 감소

### ⚠️ **문제점**
- 학습 정확도 하락 (73.50% vs 91.34%)
- 과도하게 엄격한 기준으로 인한 성능 저하
- 실제 타겟도 많이 고스트로 분류될 위험

## 🔍 **거리 임계값 효과**
- **0.5m 기준**: 더 관대한 실제 타겟 인정
- **0.3m 기준**: LiDAR 바로 옆 레이더만 실제 타겟 인정
- **결과**: 너무 엄격해서 실용성 저하

## 🔄 **다음 단계**
이 실험 결과 0.3m가 너무 엄격함을 확인:
- 거리 임계값을 0.5m로 복원
- k=4는 유지하여 이웃 영향만 감소
- 정밀도와 재현율의 균형점 탐색
