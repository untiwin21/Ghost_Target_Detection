# SNR 10dB + k=6 + 거리 0.4m 추론

## 📋 **추론 개요**
- **목적**: 학습된 k=6, SNR≥10dB 모델로 고스트 타겟 탐지 추론
- **특징**: 낮은 SNR 임계값으로 더 많은 실제 타겟 보존
- **시각화**: 전체 뷰 + 레이더 중심 확대 뷰 2개 생성

## ⚙️ **추론 설정**
| 파라미터 | 값 | 설명 |
|---------|-----|------|
| **사용 모델** | ghost_detector_k6_10dB_0.4m.pth | 학습된 모델 가중치 |
| **k-NN 연결** | 6개 | 그래프 엣지 생성 |
| **입력 데이터** | RadarMap_v2.txt, LiDARMap_v2.txt | 추론용 데이터 |
| **출력 임계값** | 0.5 | 실제/고스트 분류 기준 |
| **SNR 특성** | 10dB 기준 | 낮은 임계값으로 포용적 분류 |

## 📁 **파일 구조**
```
SNR_10dB_k6_0.4m_inference/
├── inference_k6_10dB_0.4m.py          # 추론 및 시각화 스크립트
├── ghost_detector_k6_10dB_0.4m.pth    # 학습된 모델 (복사 필요)
├── k6_10dB_all_frames.png             # 전체 뷰 시각화 (생성됨)
├── k6_10dB_radar_focused.png          # 레이더 중심 확대 뷰 (생성됨)
├── hybrid_ghost_gnn.py                # GNN 모델 정의
├── data_structures.py                 # 데이터 구조 정의
├── RadarMap_v2.txt                   # 추론용 레이더 데이터 (복사 필요)
├── LiDARMap_v2.txt                   # 추론용 LiDAR 데이터 (복사 필요)
└── README.md                         # 이 파일
```

## 🎨 **시각화 결과**

### 📊 **k6_10dB_all_frames.png (전체 뷰)**
4패널 구성으로 전체 데이터 분석:
1. **원본 데이터**: LiDAR(파란점) + Radar(SNR 색상)
2. **예측 결과**: 실제 타겟(초록) vs 고스트 타겟(빨강)
3. **예측 확률**: 실제 타겟 확률 히트맵 (초록=높음, 빨강=낮음)
4. **통계 정보**: 데이터 개수, 확률 분석, 모델 설정 (연한 빨강 배경)

### 🔍 **k6_10dB_radar_focused.png (레이더 중심 확대 뷰)**
4패널 구성으로 레이더 포인트 중심 확대 분석:
1. **확대된 원본**: 레이더 범위 내 LiDAR + Radar 상세 표시
2. **확대된 예측**: 실제/고스트 분류 결과 상세 표시
3. **확대된 확률**: 예측 확률 히트맵 상세 표시
4. **확대 정보**: 범위, 포인트 수, SNR 분포, SNR≥10dB 특징

## 🚀 **사용법**
```bash
# 필요한 파일들 복사
cp ../SNR_10dB_k6_0.4m_training/ghost_detector_k6_10dB_0.4m.pth .
cp ../SNR_10dB_k6_0.4m_training/RadarMap_v2.txt .
cp ../SNR_10dB_k6_0.4m_training/LiDARMap_v2.txt .
cp ../SNR_10dB_k6_0.4m_training/hybrid_ghost_gnn.py .
cp ../SNR_10dB_k6_0.4m_training/data_structures.py .

# 추론 실행
cd SNR_10dB_k6_0.4m_inference
python3 inference_k6_10dB_0.4m.py
```

## 📈 **예상 추론 결과**

### 📊 **성능 지표**
- **실제 타겟 비율**: ~29% (학습 데이터 기준, 15dB와 동일)
- **고스트 타겟 비율**: ~71%
- **검증 정확도**: 92.60% (15dB 모델보다 약간 높음)
- **특징**: 낮은 SNR 임계값으로 더 포용적인 분류

### 🎯 **SNR≥10dB vs SNR≥15dB 비교**
| 지표 | SNR≥15dB | **SNR≥10dB** | 차이점 |
|------|----------|-------------|--------|
| **검증 정확도** | 92.07% | **92.60%** | +0.53% |
| **실제 타겟 보존** | 보통 | **높음** | 더 포용적 |
| **약한 신호 처리** | 제한적 | **포함** | 낮은 SNR도 실제로 분류 |
| **실용성** | 균형 | **최대** | 실제 환경 적합 |

## 🔍 **분석 포인트**

### ✅ **SNR≥10dB 모델의 특징**
1. **최대 실제 타겟 보존**: 약한 신호도 실제 타겟으로 분류
2. **포용적 접근**: 엄격한 기준보다 실용적 선택
3. **균형잡힌 학습**: 더 많은 실제 타겟으로 균형 개선
4. **실제 환경 적합**: 다양한 SNR 분포에 적응

### 🎨 **시각화 해석**
- **파란 점**: LiDAR 포인트 (실제 물체 위치)
- **초록 점**: 실제 타겟으로 예측된 레이더 신호 (더 많음)
- **빨간 점**: 고스트 타겟으로 예측된 레이더 신호
- **연한 빨강 배경**: SNR≥10dB 모델임을 시각적으로 구분

### 🔬 **예상 관찰 사항**
1. **더 많은 초록 점**: 15dB 모델보다 실제 타겟 증가
2. **LiDAR 인접성**: 약한 신호의 실제 타겟도 LiDAR 근처 위치
3. **확률 분포**: 실제 타겟의 확률이 더 넓은 범위에 분포
4. **공간 패턴**: 고스트 타겟의 패턴은 유사하지만 개수 감소

## 🏆 **기대 효과**
SNR 10dB + k=6 모델의 추론 결과:
- **최대 실제 타겟 보존**: 약한 신호까지 포함하는 포용적 접근
- **높은 검증 정확도**: 92.60%로 15dB 모델보다 우수
- **실용적 적용**: 실제 환경에서 가장 적합한 성능
- **균형잡힌 분류**: 실제/고스트 비율의 개선

## 🔄 **모델 비교 분석**

### 📊 **15dB vs 10dB 모델 비교**
```
SNR≥15dB 모델:
✅ 균형잡힌 성능 (92.07%)
✅ 안정적 예측
⚠️ 약한 신호 실제 타겟 손실 가능

SNR≥10dB 모델:
✅ 최고 검증 정확도 (92.60%)
✅ 최대 실제 타겟 보존
✅ 실제 환경 최적화
⚠️ 일부 고스트를 실제로 분류할 가능성
```

### 🎯 **사용 권장 상황**
- **실제 타겟 보존이 최우선**인 환경
- **약한 신호도 중요한** 응용 분야
- **실제 배포 환경**에서의 기본 모델
- **후처리 필터링**과 조합 가능한 상황

## 🔄 **후속 분석**
추론 결과를 바탕으로:
- SNR≥15dB 모델과 직접 성능 비교
- 실제 타겟 보존율 정량적 분석
- 특정 SNR 범위별 성능 분석
- 실제 환경 적용 시 최적 모델 선택 가이드
