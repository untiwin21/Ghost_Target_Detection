# SNR 10dB + k=6 + 거리 0.4m 학습

## 📋 **실험 개요**
- **목적**: 낮은 SNR 임계값으로 더 많은 실제 타겟 보존
- **배경**: SNR 10dB로 설정하여 약한 신호의 실제 타겟도 포함

## ⚙️ **모델 파라미터**
| 파라미터 | 값 | 선택 이유 |
|---------|-----|----------|
| **SNR 임계값** | 10.0 dB | 낮은 임계값으로 더 많은 실제 타겟 보존 |
| **거리 임계값** | 0.4 m | 중간 지점 (0.3m과 0.5m 사이) |
| **k-NN 연결** | 6개 | 균형잡힌 이웃 영향 |
| **학습 에포크** | 50 | 기본 설정 |
| **배치 크기** | 16 | 기본 설정 |
| **학습률** | 0.005 | Adam 옵티마이저 |

## 📊 **학습 결과**
- **최고 검증 정확도**: 학습 후 업데이트 예정
- **실제 타겟 비율**: 학습 후 업데이트 예정 (높은 비율 예상)
- **고스트 타겟 비율**: 학습 후 업데이트 예정
- **총 그래프**: 1,568개 (예상)
- **총 노드**: 48,919개 (예상)

## 📁 **파일 구조**
```
SNR_10dB_k6_0.4m_training/
├── ghost_detector_k6_10dB_0.4m.py     # k=6, SNR≥10dB 학습 스크립트
├── ghost_detector_k6_10dB_0.4m.pth    # 학습된 모델 (학습 후 생성)
├── k6_10dB_training_analysis.png      # k=6, SNR≥10dB 학습 분석
├── hybrid_ghost_gnn.py                # GNN 모델 정의
├── data_structures.py                 # 데이터 구조 정의
├── RadarMap_v2.txt                   # 학습용 레이더 데이터 (복사 필요)
├── LiDARMap_v2.txt                   # 학습용 LiDAR 데이터 (복사 필요)
└── requirements.txt                  # 패키지 의존성
```

## 🎯 **라벨링 규칙**
```python
if distance <= 0.4m AND snr >= 10.0dB:  # 낮은 SNR 임계값
    label = 1  # 실제 타겟
else:
    label = 0  # 고스트 타겟
```

## 🎨 **학습 데이터 시각화**

### 📊 **k6_10dB_training_analysis.png**
4패널 구성으로 SNR≥10dB 기준 분석:
1. **손실 함수**: 학습/검증 손실 변화
2. **정확도**: 학습/검증 정확도 변화
3. **데이터 분포**: 실제 vs 고스트 타겟 비율 (높은 실제 타겟 비율)
4. **모델 설정**: k=6, SNR≥10dB 파라미터 및 성능 정보

## 🚀 **사용법**
```bash
# 데이터 파일 복사 (메인 폴더에서)
cp RadarMap_v2.txt SNR_10dB_k6_0.4m_training/
cp LiDARMap_v2.txt SNR_10dB_k6_0.4m_training/

# k=6, SNR≥10dB 학습 실행
cd SNR_10dB_k6_0.4m_training
python3 ghost_detector_k6_10dB_0.4m.py

# GPU 환경 확인
python3 -c "import torch; print(f'CUDA: {torch.cuda.is_available()}')"
```

## 📈 **성능 분석**

### 📊 **SNR 10dB vs 다른 임계값 비교**
| 지표 | SNR≥20dB | SNR≥15dB | **SNR≥10dB** | 예상 효과 |
|------|----------|----------|-------------|----------|
| **실제 타겟 비율** | 21.3% | 29.6% | **40%+** | 대폭 증가 |
| **정확도** | 94.4% | 92.1% | **85-90%** | 약간 감소 |
| **실제 타겟 보존** | 낮음 | 보통 | **높음** | 최대 보존 |

### ✅ **SNR 10dB 설정의 장점**
1. **최대 실제 타겟 보존**: 약한 신호의 실제 타겟도 포함
2. **포용적 접근**: 엄격한 기준보다 실용적
3. **도메인 적응**: 다양한 환경의 SNR 분포에 적응
4. **균형잡힌 학습**: 실제/고스트 비율의 균형 개선

### 🎯 **SNR 10dB 선택 근거**

#### **실제 타겟 최대 보존**:
- **문제**: 높은 SNR 임계값으로 인한 실제 타겟 손실
- **해결**: 10dB로 낮춰서 약한 신호의 실제 타겟도 포함
- **효과**: LiDAR 근처의 모든 레이더 신호를 실제로 분류

#### **학습 데이터 균형**:
- **기존 20dB**: 실제 21.3% vs 고스트 78.7% (불균형)
- **개선 15dB**: 실제 29.6% vs 고스트 70.4% (개선)
- **최적 10dB**: 실제 40%+ vs 고스트 60%- (균형)

#### **실용적 접근**:
- 실제 환경에서는 약한 신호도 중요한 정보
- 고스트 제거보다 실제 타겟 보존이 더 중요
- 후처리로 추가 필터링 가능

## 🔍 **예상 학습 특성**
### **데이터 분포 변화**:
```
SNR≥20dB: 실제 13,878개 (21.3%) vs 고스트 51,310개 (78.7%)
SNR≥15dB: 실제 19,310개 (29.6%) vs 고스트 45,878개 (70.4%)
SNR≥10dB: 실제 26,000개+ (40%+) vs 고스트 39,000개- (60%-)
```

### **학습 난이도**:
- **증가 요인**: 더 많은 경계 케이스 포함
- **감소 요인**: 더 균형잡힌 데이터 분포
- **예상 정확도**: 85-90% (실용적 수준)

### **모델 특성**:
- 더 관대한 실제 타겟 분류
- 약한 신호에 대한 민감도 증가
- 실제 환경에서의 적용성 향상

## 🏆 **결론**
SNR 10dB + k=6 + 거리 0.4m 조합은:
- **최대 실제 타겟 보존**: 약한 신호까지 포함하는 포용적 접근
- **균형잡힌 학습**: 실제/고스트 비율의 개선으로 안정적 학습
- **실용적 선택**: 실제 환경에서의 적용성 최대화
- **도메인 적응**: 다양한 SNR 분포 환경에 적응 가능

## 🔄 **향후 활용**
이 SNR 10dB 모델은:
- 실제 타겟 보존이 최우선인 환경에 적합
- 다른 SNR 임계값 모델과의 성능 비교 기준
- 실제 배포 환경에서의 기본 모델로 활용 가능
- 후처리 필터링과 조합하여 정밀도 향상 가능
