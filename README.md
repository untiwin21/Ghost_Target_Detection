# λ μ΄λ” κ³ μ¤νΈ νƒ€κ² νƒμ§€ μ‹μ¤ν…

## π― ν”„λ΅μ νΈ κ°μ”

μ΄ μ‹μ¤ν…μ€ **LiDARλ¥Ό μ •λ‹µμ§€λ΅ ν™μ©ν•μ—¬ λ μ΄λ”μ κ³ μ¤νΈ νƒ€κ²μ„ μλ™ νƒμ§€**ν•λ” λ”¥λ¬λ‹ μ‹μ¤ν…μ…λ‹λ‹¤.

### ν•µμ‹¬ μ•„μ΄λ””μ–΄
```
LiDAR (μ‹¤μ  λ¬Όμ²΄λ§ νƒμ§€) + Radar (μ‹¤μ  + κ³ μ¤νΈ νƒμ§€)
                β†“
    SNR + κ±°λ¦¬ μ΅°ν•© μλ™ λΌλ²¨λ§
                β†“
    GNN λ¨λΈλ΅ κ³ μ¤νΈ νƒ€κ² μμΈ΅
```

## π“ λ°μ΄ν„° κµ¬μ΅°

### μ…λ ¥ λ°μ΄ν„°
- **RadarMap_v2.txt**: `μ‹κ°„ x y velocity SNR`
- **LiDARMap_v2.txt**: `μ‹κ°„ x y intensity`

### μ‹κ°„λ³„ ν”„λ μ„ κµ¬μ΅°
- κ° νμΌμ€ μ‹κ°„ μμ„λ΅ κΈ°λ΅λ μ—°μ† λ°μ΄ν„°
- λ™μΌν• μ‹κ°„λ€μ ν¬μΈνΈλ“¤μ΄ ν•λ‚μ **ν”„λ μ„**μ„ κµ¬μ„±
- μ: 0.19μ΄μ— 31κ° λ μ΄λ” ν¬μΈνΈ + 152κ° LiDAR ν¬μΈνΈ = Frame 0

## π― λΌλ²¨λ§ μ‹μ¤ν… (SNR + κ±°λ¦¬ μ΅°ν•©)

### Ground Truth μƒμ„± κ·μΉ™
```python
for each λ μ΄λ”_ν¬μΈνΈ:
    κ±°λ¦¬ = min(||λ μ΄λ”_ν¬μΈνΈ - LiDAR_ν¬μΈνΈ|| for LiDAR_ν¬μΈνΈ in ν”„λ μ„)
    SNR = λ μ΄λ”_ν¬μΈνΈ.SNR
    
    if κ±°λ¦¬ β‰¤ 0.5m AND SNR β‰¥ 20.0dB:
        λΌλ²¨ = 1  # μ‹¤μ  νƒ€κ²
    else:
        λΌλ²¨ = 0  # κ³ μ¤νΈ νƒ€κ²
```

### λΌλ²¨λ§ μ΅°κ±΄ μ„¤λ…
- **κ±°λ¦¬ μ΅°κ±΄**: λ μ΄λ” ν¬μΈνΈκ°€ κ°€μ¥ κ°€κΉμ΄ LiDAR ν¬μΈνΈμ—μ„ 0.5m μ΄λ‚΄
- **SNR μ΅°κ±΄**: μ‹ νΈ λ€ μ΅μλΉ„κ°€ 20dB μ΄μƒ
- **μ΅°ν•© μ΅°κ±΄**: λ‘ μ΅°κ±΄μ„ **λ¨λ‘** λ§μ΅±ν•΄μ•Ό μ‹¤μ  νƒ€κ²

## π—οΈ μ‹μ¤ν… μ•„ν‚¤ν…μ²

### GNN λ¨λΈ κµ¬μ΅°
```
μ…λ ¥ (6μ°¨μ›) β†’ GraphSAGE β†’ BatchNorm β†’ ReLU β†’ Dropout
             β†’ GraphSAGE β†’ BatchNorm β†’ ReLU β†’ Dropout  
             β†’ GraphSAGE β†’ Sigmoid β†’ μ¶λ ¥ (μ‹¤μ  νƒ€κ² ν™•λ¥ )
```

### νΉμ§• λ²΅ν„° (6μ°¨μ›)
1. `x` - X μΆν‘ (m)
2. `y` - Y μΆν‘ (m)
3. `range` - κ±°λ¦¬ (m)
4. `azimuth` - λ°©μ„κ° (rad)
5. `velocity` - μ†λ„ (μ‚¬μ© μ•ν•¨, 0μΌλ΅ μ„¤μ •)
6. `SNR` - μ‹ νΈ λ€ μ΅μλΉ„ (dB)

### κ·Έλν”„ κµ¬μ„±
- **λ…Έλ“**: κ° λ μ΄λ” ν¬μΈνΈ
- **μ—£μ§€**: k-NN (k=8) κΈ°λ° κ³µκ°„μ  μ—°κ²°
- **λ©μ **: μ£Όλ³€ ν¬μΈνΈλ“¤μ κ΄€κ³„λ¥Ό ν•™μµν•μ—¬ κ³ μ¤νΈ νƒμ§€

## π€ μ‚¬μ©λ²•

### 1. ν™κ²½ μ„¤μ •
```bash
python3 -m venv venv
source venv/bin/activate
pip install torch torchvision torchaudio torch-geometric scipy matplotlib
```

### 2. λ¨λΈ ν•™μµ
```bash
python ghost_detector.py
```

### 3. κ²°κ³Ό μ‹κ°ν™”
```bash
python visualize_detection.py
```

## π“ μ„±λ¥ κ²°κ³Ό

### μµμΆ… μ„±λ¥
- **ν•™μµ μ •ν™•λ„**: 94.75%
- **μ „μ²΄ ν…μ¤νΈ μ •ν™•λ„**: 98.1% (100κ° ν”„λ μ„ κΈ°μ¤€)
- **λ°μ΄ν„° λ¶„ν¬**: Real 25.0%, Ghost 75.0%

### λ°μ΄ν„° ν†µκ³„
- **μ΄ ν”„λ μ„**: 2,090κ°
- **μ΄ λ μ΄λ” ν¬μΈνΈ**: 65,188κ°
- **SNR λ²”μ„**: 15.0 ~ 45.4 dB
- **κ±°λ¦¬ λ²”μ„**: 0.005 ~ 12.066 m

## π“ μ‹κ°ν™” κ²°κ³Ό

### μƒμ„±λλ” νμΌλ“¤
- `detection_frame_*.png`: κ°λ³„ ν”„λ μ„ λ¶„μ„
- `detection_summary.png`: μ „μ²΄ λ°μ΄ν„° μ”μ•½
- `ghost_detector.pth`: ν•™μµλ λ¨λΈ

### μ‹κ°ν™” λ‚΄μ©
κ° μ‹κ°ν™”λ” 4κ° ν¨λ„λ΅ κµ¬μ„±:
1. **μ›λ³Έ λ°μ΄ν„°**: LiDAR(νλ€μ ) + Radar(SNR μƒ‰μƒ λ§¤ν•‘)
2. **Ground Truth**: μ‹¤μ  νƒ€κ²(μ΄λ΅) vs κ³ μ¤νΈ νƒ€κ²(λΉ¨κ°•)
3. **λ¨λΈ μμΈ΅**: μμΈ΅λ μ‹¤μ /κ³ μ¤νΈ λ¶„λ¥ + μ •ν™•λ„
4. **μμΈ΅ ν™•λ¥ **: μ‹ λΆ°λ„ ννΈλ§µ (μ΄λ΅=μ‹¤μ  ν™•μ‹ , λΉ¨κ°•=κ³ μ¤νΈ ν™•μ‹ )

## π” μ‹κ°ν™” ν•΄μ„ κ°€μ΄λ“

### μƒ‰μƒ μλ―Έ
- π”µ **νλ€ μ **: LiDAR ν¬μΈνΈ (μ‹¤μ  λ¬Όμ²΄ μ„μΉ)
- πΆ **μ΄λ΅ μ **: μ‹¤μ  νƒ€κ²μΌλ΅ λ¶„λ¥λ λ μ΄λ” μ‹ νΈ
- π”΄ **λΉ¨κ°„ μ **: κ³ μ¤νΈ νƒ€κ²μΌλ΅ λ¶„λ¥λ λ μ΄λ” μ‹ νΈ
- π **μƒ‰μƒ κ·ΈλΌλ°μ΄μ…**: SNR κ°’ λλ” μμΈ΅ ν™•λ¥ 

### λ¶„μ„ μμ‹
- **Frame 0**: λ¨λ“  λ μ΄λ” ν¬μΈνΈκ°€ LiDARμ—μ„ 0.768m μ΄μƒ λ–¨μ–΄μ Έ μμ–΄ λ¨λ‘ κ³ μ¤νΈ
- **Frame 1-10**: μΌλ¶€ λ μ΄λ” ν¬μΈνΈκ°€ LiDAR κ·Όμ²μ— μμ–΄ μ‹¤μ  νƒ€κ²μΌλ΅ λ¶„λ¥

## π”§ νμΌ κµ¬μ΅°

```
modified_ragnnarok/
β”β”€β”€ RadarMap_v2.txt              # λ μ΄λ” λ°μ΄ν„°
β”β”€β”€ LiDARMap_v2.txt              # LiDAR λ°μ΄ν„°
β”β”€β”€ data_structures.py           # λ°μ΄ν„° κµ¬μ΅° μ •μ
β”β”€β”€ hybrid_ghost_gnn.py          # GNN λ¨λΈ μ •μ
β”β”€β”€ ghost_detector.py            # λ©”μΈ μ‹μ¤ν… (ν•™μµ)
β”β”€β”€ visualize_detection.py       # μ‹κ°ν™” μ‹μ¤ν…
β”β”€β”€ ghost_detector.pth           # ν•™μµλ λ¨λΈ
β”β”€β”€ detection_frame_*.png        # κ°λ³„ ν”„λ μ„ μ‹κ°ν™”
β”β”€β”€ detection_summary.png        # μ „μ²΄ μ”μ•½ μ‹κ°ν™”
β””β”€β”€ README.md                    # μ΄ νμΌ
```

## π― κΈ°μ μ  νΉμ§•

### νμ‹ μ 
1. **λ©€ν‹° μ„Όμ„ μµν•©**: LiDAR + Radar λ°μ΄ν„° ν™μ©
2. **μ§€λ¥ν• λΌλ²¨λ§**: κ±°λ¦¬ + μ‹ νΈ μ„ΈκΈ° μ΅°ν•© νλ‹¨
3. **κ³µκ°„ κ΄€κ³„ ν•™μµ**: GraphSAGE κΈ°λ° GNNμΌλ΅ μ£Όλ³€ ν¬μΈνΈ κ΄€κ³„ ν•™μµ
4. **μ‹¤μ‹κ°„ μ²λ¦¬**: GPU κ°€μ†μΌλ΅ λΉ λ¥Έ ν•™μµ/μ¶”λ΅ 

### μ¥μ 
- β… **μ™„μ „ μλ™ν™”**: μλ™ λΌλ²¨λ§ λ¶ν•„μ”
- β… **λ†’μ€ μ •ν™•λ„**: 98% μ΄μƒμ μ•μ •μ  μ„±λ¥
- β… **μ‹¤μ©μ **: μ‹¤μ  μ„Όμ„ λ°μ΄ν„°λ΅ κ²€μ¦
- β… **ν™•μ¥ κ°€λ¥**: λ‹¤λ¥Έ ν™κ²½/μ„Όμ„μ— μ μ© κ°€λ¥

### ν•κ³„μ 
- β οΈ **LiDAR μμ΅΄μ„±**: Ground Truth μƒμ„±μ„ μ„ν•΄ LiDAR ν•„μ
- β οΈ **μ„κ³„κ°’ λ―Όκ°μ„±**: ν™κ²½μ— λ”°λ¥Έ μ„κ³„κ°’ μ΅°μ • ν•„μ”
- β οΈ **μ •μ  ν™κ²½ νΉν™”**: ν„μ¬ λ°μ΄ν„°λ” λΉ„κµμ  μ •μ μΈ ν™κ²½

## π¤ ν™μ© λ¶„μ•Ό

### μμ¨μ£Όν–‰
- λ μ΄λ” κ³ μ¤νΈ νƒ€κ² μ κ±°λ΅ μ•μ „μ„± ν–¥μƒ
- μ‹¤μ‹κ°„ λ¬Όμ²΄ νƒμ§€ μ •ν™•λ„ κ°μ„ 

### λ΅λ΄‡ λ‚΄λΉ„κ²μ΄μ…
- μ‹¤λ‚΄/μ‹¤μ™Έ ν™κ²½μ—μ„ μ •ν™•ν• μ¥μ• λ¬Ό μΈμ‹
- κ³ μ¤νΈ νƒ€κ²μΌλ΅ μΈν• μ¤μ‘λ™ λ°©μ§€

### λ³΄μ• μ‹μ¤ν…
- μΉ¨μ… νƒμ§€ μ‹ false alarm κ°μ†
- μ‹¤μ  μ„ν‘κ³Ό κ³ μ¤νΈ μ‹ νΈ κµ¬λ¶„

## π“ μ°Έκ³  λ¬Έν—
- RaGNNarok: A Lightweight RADAR Graph Neural Network for Real-Time Indoor Autonomous Robot Radar Ghost Detection
- Ghost Target Detection in Automotive Radar Systems using PointNet

---
**Modified RaGNNarok** - SNR + κ±°λ¦¬ μ΅°ν•© κΈ°λ° λ μ΄λ” κ³ μ¤νΈ νƒ€κ² μλ™ νƒμ§€ μ‹μ¤ν…
