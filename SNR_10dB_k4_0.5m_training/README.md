# SNR 10dB + k=4 + 거리 0.5m 학습 (최적화된 기준)

## 📋 **실험 개요**
- **목적**: k-NN 연결 수는 줄이고 거리 기준은 실용적으로 유지
- **전략**: 이웃 과의존 문제 해결 + 실용적 거리 기준 유지

## ⚙️ **모델 파라미터**
| 파라미터 | 값 | 변경 이유 |
|---------|-----|----------|
| **SNR 임계값** | 10.0 dB | 기존 유지 |
| **거리 임계값** | 0.5 m | 0.3m → 0.5m (실용성 복원) |
| **k-NN 연결** | 4개 | 8개 → 4개 (이웃 영향 감소) |
| **학습 에포크** | 50 | 기본 설정 |
| **배치 크기** | 16 | 기본 설정 |
| **학습률** | 0.005 | Adam 옵티마이저 |

## 📊 **학습 결과**
- **최고 검증 정확도**: 74.14%
- **실제 타겟 비율**: 35.1% (22,897개)
- **고스트 타겟 비율**: 64.9% (42,291개)
- **총 그래프**: 2,090개
- **총 노드**: 65,188개

## 📁 **파일 구조**
```
SNR_10dB_k4_0.5m_training/
├── ghost_detector_k4_0.5m.py      # 최적화된 학습 스크립트
├── ghost_detector_k4_0.5m.pth     # 학습된 모델 (74.14% 정확도)
├── optimized_training_analysis.png # 최적화된 학습 데이터 분석
├── hybrid_ghost_gnn.py            # GNN 모델 정의
├── data_structures.py             # 데이터 구조 정의
├── RadarMap_v2.txt               # 학습용 레이더 데이터
├── LiDARMap_v2.txt               # 학습용 LiDAR 데이터
└── requirements.txt              # 패키지 의존성
```

## 🎯 **최적화된 라벨링 규칙**
```python
if distance <= 0.5m AND snr >= 10.0dB:  # 균형잡힌 기준
    label = 1  # 실제 타겟
else:
    label = 0  # 고스트 타겟
```

## 🎨 **학습 데이터 시각화**

### 📊 **optimized_training_analysis.png**
4패널 구성으로 최적화된 기준 분석:
1. **원본 데이터**: LiDAR + Radar (SNR 색상)
2. **최적화된 라벨링**: k=4, 0.5m + 10dB 기준 적용
3. **거리 분포**: 0.5m vs 0.3m 임계값 비교 (0.5m 복원)
4. **통계 정보**: 균형잡힌 기준의 효과

## 🚀 **사용법**
```bash
# 최적화된 학습 실행
python3 ghost_detector_k4_0.5m.py

# GPU 환경 확인
python3 -c "import torch; print(f'CUDA: {torch.cuda.is_available()}')"
```

## 📈 **성능 분석**

### 📊 **다른 모델들과 비교**
| 모델 | k-NN | 거리 | 학습 정확도 | 실제 타겟 비율 |
|------|------|------|------------|-------------|
| **기본** | k=8 | 0.5m | 91.34% | 35.1% |
| **엄격** | k=4 | 0.3m | 73.50% | 22.2% |
| **최적화** | k=4 | 0.5m | **74.14%** | **35.1%** |

### ✅ **장점**
- **균형잡힌 성능**: 실용적 거리 + 감소된 이웃 영향
- **실제 타겟 보존**: 35.1% 유지 (0.3m 기준 대비 크게 개선)
- **이웃 과의존 해결**: k=4로 개별 특성 중시

### 🎯 **최적화 효과**
- **거리 기준 복원**: 0.3m → 0.5m으로 실용성 회복
- **k-NN 감소**: 8개 → 4개로 이웃 과의존 문제 해결
- **균형점 달성**: 정밀도와 재현율의 실용적 균형

## 🔍 **k=4 연결의 효과**
- **기존 k=8**: 주변 8개 포인트 영향 → 과도하게 관대한 판단
- **최적화 k=4**: 주변 4개 포인트 영향 → 더 엄격하고 개별적 판단
- **결과**: 이웃에 휘둘리지 않는 독립적 판단 능력 향상

## 🔄 **다음 단계**
이 최적화된 모델로 추론 성능 평가:
- bokdo3 데이터에서 실제 성능 검증
- 기존 모델 대비 고스트 탐지 정밀도 개선 확인
- 실용적 균형점 달성 여부 평가
