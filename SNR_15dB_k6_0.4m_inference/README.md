# SNR 15dB + k=6 + 거리 0.4m 추론

## 📋 **추론 개요**
- **목적**: 학습된 k=6, SNR≥15dB 모델로 고스트 타겟 탐지 추론
- **시각화**: 전체 뷰 + 레이더 중심 확대 뷰 2개 생성

## ⚙️ **추론 설정**
| 파라미터 | 값 | 설명 |
|---------|-----|------|
| **사용 모델** | ghost_detector_k6_15dB_0.4m.pth | 학습된 모델 가중치 |
| **k-NN 연결** | 6개 | 그래프 엣지 생성 |
| **입력 데이터** | RadarMap_v2.txt, LiDARMap_v2.txt | 추론용 데이터 |
| **출력 임계값** | 0.5 | 실제/고스트 분류 기준 |

## 📁 **파일 구조**
```
SNR_15dB_k6_0.4m_inference/
├── inference_k6_15dB_0.4m.py          # 추론 및 시각화 스크립트
├── ghost_detector_k6_15dB_0.4m.pth    # 학습된 모델 (복사 필요)
├── k6_15dB_all_frames.png             # 전체 뷰 시각화 (생성됨)
├── k6_15dB_radar_focused.png          # 레이더 중심 확대 뷰 (생성됨)
├── hybrid_ghost_gnn.py                # GNN 모델 정의
├── data_structures.py                 # 데이터 구조 정의
├── RadarMap_v2.txt                   # 추론용 레이더 데이터 (복사 필요)
├── LiDARMap_v2.txt                   # 추론용 LiDAR 데이터 (복사 필요)
└── README.md                         # 이 파일
```

## 🎨 **시각화 결과**

### 📊 **k6_15dB_all_frames.png (전체 뷰)**
4패널 구성으로 전체 데이터 분석:
1. **원본 데이터**: LiDAR(파란점) + Radar(SNR 색상)
2. **예측 결과**: 실제 타겟(초록) vs 고스트 타겟(빨강)
3. **예측 확률**: 실제 타겟 확률 히트맵 (초록=높음, 빨강=낮음)
4. **통계 정보**: 데이터 개수, 확률 분석, 모델 설정

### 🔍 **k6_15dB_radar_focused.png (레이더 중심 확대 뷰)**
4패널 구성으로 레이더 포인트 중심 확대 분석:
1. **확대된 원본**: 레이더 범위 내 LiDAR + Radar 상세 표시
2. **확대된 예측**: 실제/고스트 분류 결과 상세 표시
3. **확대된 확률**: 예측 확률 히트맵 상세 표시
4. **확대 정보**: 범위, 포인트 수, SNR 분포, 확대 효과

## 🚀 **사용법**
```bash
# 필요한 파일들 복사
cp ../SNR_15dB_k6_0.4m_training/ghost_detector_k6_15dB_0.4m.pth .
cp ../SNR_15dB_k6_0.4m_training/RadarMap_v2.txt .
cp ../SNR_15dB_k6_0.4m_training/LiDARMap_v2.txt .
cp ../SNR_15dB_k6_0.4m_training/hybrid_ghost_gnn.py .
cp ../SNR_15dB_k6_0.4m_training/data_structures.py .

# 추론 실행
cd SNR_15dB_k6_0.4m_inference
python3 inference_k6_15dB_0.4m.py
```

## 📈 **예상 추론 결과**

### 📊 **성능 지표**
- **실제 타겟 비율**: ~29% (학습 데이터 기준)
- **고스트 타겟 비율**: ~71%
- **평균 예측 확률**: 실제 타겟 > 0.7, 고스트 타겟 < 0.3

### 🎯 **시각화 특징**
- **전체 뷰**: 복도 전체 구조와 패턴 파악
- **확대 뷰**: 레이더-LiDAR 관계 상세 분석
- **색상 구분**: 직관적인 실제/고스트 구분
- **확률 표시**: 모델 신뢰도 시각화

## 🔍 **분석 포인트**

### ✅ **확인할 사항**
1. **LiDAR 인접성**: 실제 타겟이 LiDAR 근처에 위치하는지
2. **고스트 패턴**: 고스트 타겟의 공간적 분포 패턴
3. **SNR 관계**: 높은 SNR과 실제 타겟의 상관관계
4. **확률 분포**: 예측 확률의 분포와 임계값 적절성

### 🎨 **시각화 해석**
- **파란 점**: LiDAR 포인트 (실제 물체 위치)
- **초록 점**: 실제 타겟으로 예측된 레이더 신호
- **빨간 점**: 고스트 타겟으로 예측된 레이더 신호
- **색상 그라데이션**: SNR 값 또는 예측 확률

## 🏆 **기대 효과**
SNR 15dB + k=6 모델의 추론 결과:
- **균형잡힌 성능**: 실제 타겟 보존과 고스트 제거의 균형
- **안정적 예측**: 92.07% 검증 정확도 기반 신뢰성
- **실용적 적용**: 실제 환경에서 활용 가능한 성능
- **시각적 검증**: 직관적인 결과 확인 가능

## 🔄 **후속 분석**
추론 결과를 바탕으로:
- 다른 SNR 임계값 모델과 성능 비교
- 특정 영역의 상세 분석
- 시간대별 성능 변화 분석
- 실제 환경 적용 가능성 평가
